blueprint:
  name: Daily Utility Cost Notification
  description: "`- Version: 0.4 -`\n\n Send a notification to device every day with the usage cost of selected entities."
  domain: automation
  input:
    sensors:
      name: Electricity Cost Sensors
      description: Select the sensors that track electricity usage for air conditioning.
      selector:
        entity:
          domain: sensor
          multiple: true
    notify_device:
      name: Device to notify push
      default: false
      description: 'Device needs to run the official Home Assistant app to receive notifications.'
      selector:
        device: 
          integration: mobile_app

trigger:
  - platform: time
    at: "23:55:00"

action:
  - service: notify
    target:
      entity_id: !input notify_device
    data:
      title: "Spotreba"
      message: >
        {% set total_usage = 0 %}
        {% for sensor in sensors %}
          {% set total_usage = total_usage + states(sensor) | float %}
        {% endfor %}
        ðŸŒž Daily Electricity Usage ðŸŒž:
        {% for sensor in sensors %}
          {% set friendly_name = state_attr(sensor, 'friendly_name') %}
          {% set friendly_name = friendly_name | regex_replace('[0-9]', '') %}
          {% set friendly_name = friendly_name | regex_replace('Plug', '') %}
          {% set friendly_name = friendly_name | regex_replace('daily', '') %}
          - {{ friendly_name | trim }}: â‚¬{{ states(sensor) }}
        {% endfor %}
        Total: â‚¬{{ total_usage }}

mode: single